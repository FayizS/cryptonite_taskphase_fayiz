## dont-use-client-side
Started of by opening the website then inspecting the button element, I found that the verify button calls a verify() function.
Went to the script part of the code and found the verify() function where the flag was given in a jumbled manner.
Tracing the numbers given in split I found the flag.(0-1, 1-2, 2-3,.... and so on);

## Inspect HTML
The challenge was pretty simple, just had to inspect the page and the flag was directly given in the code.

## Intro to Burp
Installed Burp Suite, I went through the hints and found that I should mangle the request, so I searched how to do it.
First I opened the webiste on the Burp Browser, used Proxy->Intercept, sent it to a repeater.
Then on the OTP screen I sent a request where I removed the OTP Body Parameter Request and got the Flag.

## where are the robots
I was pretty confused with this program so I had to do some reasearch.
I learned about robots.txt which is a file which tells the crawlers(a program that scans websites.) what can be accessed on the website.
So I appended /robots.txt which gave me a screen that displayed the information of a page that has been disallowd. I went there to get the flag.

## SQL Direct
Downloaded postgreSQL for this problem.
I got into the right database using \l to list and \c {Database Name} to change to that database.
Found the flag table and I tried reading the table using SELECT * FROM flag but its not working.
I realised that I missed the semicolon...

## Some Assembly Required 1
Decoded the obfuscated code. Then I tried changing the code to give me the flag, but that didn't work out.
Just went through the wasm file in sources and found the flag there.

## Who are you?
The website wanted me to access it from PicoBrowser.
So I went into Burp and intercepted it and replaced chrome with PicoBrowser in the request, then it showed that it doesnt trust users from other websites.

## Power Cookies
- On launching the instance we get this webpage:
  <img src="./images/PowerCookies1.png">
- After clicking the button I came to a dead end.
  <img src="./images/PowerCookies2.png">
- So I went back to inspect HTML, where I found the function that the button calls.
  <img src="./images/PowerCookies3.png">
- I went to the script to check the function.
  <img src="./images/PowerCookies4.png">
- Here I changed the value from `document.cookie = "isAdmin=0"` to `document.cookie = "isAdmin=1"`.
- After saving this, I clicked on the button and got the flag.
  <img src="./images/PowerCookies5.png">

## Who are you?
- This challenge opens up a website showing this:
<img src="./images/whoareyou1.png">
- I tried inspecting element but that didn't help, so I opened the website using BurpSuite.
<img src="./images/whoareyou2.png">
- I only saw that the User-agent value showed the Browser information, so I changed it to PicoBrowser.
<img src="./images/whoareyou3.png">
- The webpage showed me this.
<img src="./images/whoareyou4.png">
- This got me stuck for a bit, so I used the hint and learned about RFC(Request For Comments, Documentation regarding standards and rules for internet).
- I did some research to understand what is actually happening.<br> [Given Here](WebExp_Extra.md)
- Since the website does not want users visiting from another website I added another header `Referer:` (Which I found here: https://datatracker.ietf.org/doc/html/rfc2616#section-3.3) in which I specified the same website.
<img src="./images/whoareyou5.png">
- Now it wants me to change the date:
<img src="./images/whoareyou6.png">
- I went through the RFC documentation for date to find the format.
<img src="./images/whoareyou7.png">
- Then added it to the request and got:
<img src="./images/whoareyou8.png">
<img src="./images/whoareyou9.png">
- After searching I found that you use `DNT:` header to set 0/1 for tracking.
<img src="./images/whoareyou10.png">
<img src="./images/whoareyou11.png">
- Now it requires me to be from Sweden, so I tried changing language/locations and nothing worked, after a bit more trial and error I figured out that I have to specify a Swedish IP address using `X-Forwarded-For:` header, So I searched up a Swedish IP and added this header.
<img src="./images/whoareyou12.png">
<img src="./images/whoareyou13.png">
- I changed the language to sv-SE using `Accept-Language:` header and finally got the flag.
<img src="./images/whoareyou14.png">
<img src="./images/whoareyou15.png">

## More SQLi
- Opened the website:
<img src="./images/moresqli1.png">
- On inputting random credentials:
<img src="./images/moresqli2.png">  
- Then I researched a bit on SQL injection and found [this](https://learn.snyk.io/lesson/sql-injection/) website helpful.
- I tried to put `idontknow' or 1=1; --` into the username and password.
<img src="./images/moresqli3.png">
- I tried running the same thing again in the search bar but got nothing, Then checked the hint to find that it is SQLite.
- I tried to inject _SHOW TABLES_ but it didn't work, after asking ChatGPT I found out the metadata was stored in a system table _sqlite_master_, now to access it I used `' UNION SELECT name,sql,null FROM sqlite_master; --`.
- I used _null_ here to match the column count which is 3.
<img src="./images/moresqli4.png">
- Now I found out that _more_table_ contains the flag, so I used `' UNION SELECT flag,null,null FROM more_table; --` and got the flag.
<img src="./images/moresqli5.png">
#### Note:
- `--` is used to indicate a comment and it will ignore everything afterwards.
- The _sql_ column contains the CREATE statement that defines the structure of the object.
- We use UNION in SQL injection to combine the results of an injected query with the results of the original query.

## Most Cookies
- At first I tried to used _Intruder_ in Burp to try out all the various cookies which I got from the _server.py_ file given in the problem, this did not work.
- Being completely clueless I had to search up a guide for this challenge and understood how to do it.
- Clicking the link gives this:
<img src="./images/mostcookies1.png">
- The _server.py_ file gives a clue that the a cookie is selected at random to be the _secert_key_.
- We need to crack the JWT token and set it to admin(by tricking it) to get the flag. (Session Hijacking)
- This requires a utility _flask-unsign_ .
```
py -m pip install flask-unsign
```
- We need to use unsign from this package.
<img src="./images/mostcookies2.png">
- We use _--wordlist_ to add the words used to brute force attack unsigned cookies.
<img src="./images/mostcookies3.png">
- I added the cookies which were given in the _server.py_ to the wordlist.
<img src="./images/mostcookies4.png">
- Now I use this to find that can successfully verify or unsign the cookie.
```
 flask-unsign -u --server "http://mercury.picoctf.net:44693/" --wordlist cookies.txt
```
- breakdown:
  - `-u` is used to specify that you want to fetch the cookie from the URL specified.
  - `--server "http://mercury.picoctf.net:44693/"` specifies the target server.
  - `--wordlist cookies.txt` points to the wordlist that needs to be used.
<img src="./images/mostcookies5.png">
- We have found out that the secret key is _butter_.
- Now we use the same utility to recraft the cookie.
```
flask-unsign -s -c "{'very_auth': 'admin'}" -S butter
```
- breakdown:
  - `-s` tells the utility to sign the cookie
  - `-c "{'very_auth': 'admin'}"` specifies the cookie content. The string contains the content of the cookie we are attempting to forge/sign.
  - `-S` is used to specify the secret key with which we use to sign the cookie, which in this case is `butter`.
<img src="./images/mostcookies6.png">
- We take this cookie and paste into the session cookie and hit refresh.
<img src="./images/mostcookies7.png">

#### Note:
- JWTs(JSON Web Token) is open open standard to share security information between two parties - client and a server.
- Session Hijacking - This allows attackers that can read the network traffic to intercept all the data that is submitted to the server or web pages viewed by the client. Since this data includes the session cookie, it allows them to impersonate the victim, even if the password itself is not compromised.
- 













